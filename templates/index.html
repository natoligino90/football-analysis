<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8" />
<title>Football Analysis Doppia API</title>
</head>
<body>
    <label for="competition">Campionato:</label>
    <select id="competition">
        <option value="135">Serie A</option>
        <option value="39">Premier League</option>
        <option value="78">Bundesliga</option>
    </select>
    <input id="giorno" type="date" value="2025-10-21" />

    <button onclick="cercaFootballData()">Cerca Football-Data</button>
    <button onclick="cercaAPISports()">Cerca API-Football</button>

    <h3>Dati Football-Data.org</h3>
    <table id="result" border="1" cellspacing="0" cellpadding="6"><tbody></tbody></table>

    <h3>Dati API-Football Sports</h3>
    <table id="apisports" border="1" cellspacing="0" cellpadding="6"><tbody></tbody></table>

<script>
function cercaFootballData() {
    let comp = document.getElementById('competition').value;
    let days = 7; // o altro parametro se vuoi
    fetch(`/api/palinsesto?competition=${comp}&days=${days}`)
        .then(res => res.json())
        .then(data => {
            let rows = '';
            if(data.success) {
                data.data.matches.forEach(m => {
                    rows += `<tr><td>${m.utcDate.substring(0,10)}</td>
                        <td>${m.competition.name}</td>
                        <td>${m.homeTeam.name}</td>
                        <td>${m.awayTeam.name}</td>
                    </tr>`;
                });
            }
            else rows = `<tr><td colspan="4">${data.error}</td></tr>`;
            document.querySelector('#result tbody').innerHTML = rows;
        });
}

function cercaAPISports() {
    let league_id = document.getElementById('competition').value;
    let date = document.getElementById('giorno').value;
    fetch(`/api/fixtures_apisports?league_id=${league_id}&date=${date}`)
        .then(res => res.json())
        .then(data => {
            let rows = '';
            if(data.success) {
                data.data.response.forEach(f => {
                    rows += `<tr><td>${f.fixture.date.substring(0,10)}</td>
                        <td>${f.teams.home.name}</td>
                        <td>${f.teams.away.name}</td>
                        <td>${f.fixture.status.short}</td>
                    </tr>`;
                });
            }
            else rows = `<tr><td colspan="4">${data.error}</td></tr>`;
            document.querySelector('#apisports tbody').innerHTML = rows;
        });
}
</script>
</body>
</html>
